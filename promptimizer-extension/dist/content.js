let n="";document.addEventListener("mouseup",()=>{n=window.getSelection().toString().trim(),n&&n.length>10&&chrome.storage.local.set({selectedText:n})});chrome.runtime.onMessage.addListener((t,c,i)=>{if(t.action==="getSelectedText")i({text:n});else if(t.action==="insertOptimizedPrompt"){const e=document.activeElement;e&&(e.tagName==="TEXTAREA"||e.tagName==="INPUT"||e.contentEditable==="true")?(e.tagName==="TEXTAREA"||e.tagName==="INPUT"?(e.value=t.prompt,e.dispatchEvent(new Event("input",{bubbles:!0}))):(e.textContent=t.prompt,e.dispatchEvent(new Event("input",{bubbles:!0}))),i({success:!0})):i({success:!1,error:"No active text input found"})}});
