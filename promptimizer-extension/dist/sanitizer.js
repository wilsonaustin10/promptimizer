function r(t){if(typeof t!="string")return"";let e=t.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F]/g,"");const n=5e4;return e.length>n&&(e=e.substring(0,n)+"... [truncated]"),e}function i(t){return!t||typeof t!="string"?!1:![/<script/i,/javascript:/i,/vbscript:/i,/on\w+\s*=/i,/<iframe/i,/<object/i,/<embed/i,/<form/i].some(n=>n.test(t))}function o(t,e){if(!t||!t.textContent!==void 0)throw new Error("Invalid DOM element provided");const n=r(e);return i(n)?(t.textContent=n,!0):(console.warn("Potentially dangerous content blocked:",e.substring(0,100)),t.textContent="[Content blocked for security]",!1)}function s(t,e){if(!t||typeof t.value>"u")throw new Error("Invalid input element provided");const n=r(e);return i(n)?(t.value=n,!0):(console.warn("Potentially dangerous input blocked:",e.substring(0,100)),t.value="[Content blocked for security]",!1)}export{s as a,o as b,r as s,i as v};
